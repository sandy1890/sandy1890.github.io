<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="react," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="概述React本身仅只是一个视图层的解决方案，真实项目中还需要配合其它库来进行开发。这里介绍的是一个可进行完整项目开发的技术栈。将介绍以下这些库及它们之间如何配合来完成一个完整的项目开发。  react 处理视图 react-router 前端路由 redux 应用状态管理，即数据获取及处理 react-redux react官方redux绑定 redux-thunk　扩展redux,方便处理异步">
<meta name="keywords" content="react">
<meta property="og:type" content="article">
<meta property="og:title" content="React开发技术栈">
<meta property="og:url" content="https://blog.sandy1890.com/2016/05/20/React开发技术栈/index.html">
<meta property="og:site_name" content="安迪桑的笔记">
<meta property="og:description" content="概述React本身仅只是一个视图层的解决方案，真实项目中还需要配合其它库来进行开发。这里介绍的是一个可进行完整项目开发的技术栈。将介绍以下这些库及它们之间如何配合来完成一个完整的项目开发。  react 处理视图 react-router 前端路由 redux 应用状态管理，即数据获取及处理 react-redux react官方redux绑定 redux-thunk　扩展redux,方便处理异步">
<meta property="og:updated_time" content="2017-07-04T06:51:19.164Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React开发技术栈">
<meta name="twitter:description" content="概述React本身仅只是一个视图层的解决方案，真实项目中还需要配合其它库来进行开发。这里介绍的是一个可进行完整项目开发的技术栈。将介绍以下这些库及它们之间如何配合来完成一个完整的项目开发。  react 处理视图 react-router 前端路由 redux 应用状态管理，即数据获取及处理 react-redux react官方redux绑定 redux-thunk　扩展redux,方便处理异步">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="https://blog.sandy1890.com/2016/05/20/React开发技术栈/"/>





  <title>React开发技术栈 | 安迪桑的笔记</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">安迪桑的笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://blog.sandy1890.com/2016/05/20/React开发技术栈/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sandy1890">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="安迪桑的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">React开发技术栈</h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>React本身仅只是一个视图层的解决方案，真实项目中还需要配合其它库来进行开发。这里介绍的是一个可进行完整项目开发的技术栈。将介绍以下这些库及它们之间如何配合来完成一个完整的项目开发。</p>
<ul>
<li><a href="https://facebook.github.io/react/" target="_blank" rel="external">react</a> 处理视图</li>
<li><a href="https://github.com/reactjs/react-router" target="_blank" rel="external">react-router</a> 前端路由</li>
<li><a href="http://redux.js.org/" target="_blank" rel="external">redux</a> 应用状态管理，即数据获取及处理</li>
<li><a href="https://github.com/reactjs/react-redux" target="_blank" rel="external">react-redux</a> react官方redux绑定</li>
<li><a href="https://github.com/gaearon/redux-thunk" target="_blank" rel="external">redux-thunk</a>　扩展redux,方便处理异步请求</li>
</ul>
<h2 id="react"><a href="#react" class="headerlink" title="react"></a>react</h2><p>react的核心是组件，了解组件的核心是搞清楚组件生命周期。组件之后，需要了解的是react组件之间信息流的传递，主要是通过<code>props</code>(包含回调函数，组件渲染所需要的数据等)</p>
<p>组件定义，组件通过 React.createClass()创建，包含以下一些定义</p>
<ul>
<li>render()</li>
<li>getInitialState()</li>
<li>getDefaultProps()</li>
<li>propTypes</li>
<li>mixins</li>
<li>statics</li>
</ul>
<p>react组件生命周期函数：</p>
<ul>
<li>componentWillMount()</li>
<li>componentDidMount()</li>
<li>componentWillReceiveProps()</li>
<li>shouldComponentUpdate()</li>
<li>componentWillUpdate()</li>
<li>componentDidUpdate()</li>
<li>componentWillUnmount()</li>
</ul>
<p>包含所有定义和生命周期函数的组件定义看起来像下面这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> Home = React.createClass(&#123;</div><div class="line">    <span class="attr">mixins</span>:[],</div><div class="line">    <span class="attr">statics</span>: &#123;&#125;,</div><div class="line">    <span class="attr">propTypes</span>:&#123;&#125;,</div><div class="line">    <span class="attr">getInitialState</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">getDefaultProps</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">render</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentWillMount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentDidMount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentWillReceiveProps</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">shouldComponentUpdate</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentWillUpdate</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentDidUpdate</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    <span class="attr">componentWillUnmount</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>ES6</code>的写法略有不同，看起来像这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">Reac</span>.<span class="title">Component</span></span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props)&#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">        <span class="keyword">this</span>.state = &#123;&#125;; <span class="comment">//取代getDefaultState()</span></div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="react-router"><a href="#react-router" class="headerlink" title="react-router"></a>react-router</h2><p>没有太多学习成本，主要功能就是提供路由和组件的绑定。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ReactDOM.render((</div><div class="line">    &lt;Router history=&#123;history&#125;&gt;</div><div class="line">            &lt;Route path="/" component=&#123;App&#125;&gt;</div><div class="line">                &lt;IndexRoute component=&#123;Home&#125;/&gt;</div><div class="line">                &lt;Route path="about" component=&#123;About&#125;/&gt;</div><div class="line">            &lt;/Route&gt;</div><div class="line">            &lt;Route path="/other" component=&#123;Other&#125;&gt;</div><div class="line">    &lt;/Router&gt;</div><div class="line">), document.getElementById('react-content'))</div></pre></td></tr></table></figure>
<p>解释，上面的代码定义了一个路由规则</p>
<ul>
<li>访问　<code>/</code>　路径的时候，渲染Home组件</li>
<li>访问　<code>/about</code> 路径的时候，渲染About组件</li>
<li>访问 <code>/other</code>　路径的时候，渲染Other组件</li>
</ul>
<p>需要注意到<code>Home</code>和<code>About</code>被包含在App组件中，这样定义实现的效果是，<code>Home</code>和<code>About</code>组件的渲染会包裹在App组件中，实际上相当于我们平时开发流程中使用的<code>layout</code>视图层，这里的<code>App</code>组件就相当于<code>Home</code>和<code>About</code>的<code>layout</code>。来看一下App组件的render()方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">          &lt;Header/&gt;</div><div class="line">          &#123;this.props.children&#125;</div><div class="line">          &lt;Footer/&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的代码，在App组件中，我们通过 <code>this.props.children</code> 来获取当前路由对应的子组件（本例中的Home或About）,可以看出，在App组件中，我们还增加了<code>Header</code>和<code>Footer</code>两个组件，给<code>About</code>和<code>Home</code>加上了页头页尾</p>
<p>另外需要注意的是<code>history</code>这个<code>props</code>,它有三个选项</p>
<ul>
<li>browserHistory 基于浏览器URL(使链接更有意义，符合通常的认识，一般需要服务端支持url重写)</li>
<li>hashHistory 基于url的hash值(url中<code>#</code>之后的部分)</li>
<li>createMemoryHistory</li>
</ul>
<p>其它常用的组件:</p>
<ul>
<li><code>&lt;Link&gt;</code></li>
<li><code>&lt;Redirect&gt;</code></li>
</ul>
<p>以上是简单介绍，更多信息可访问<a href="https://github.com/reactjs/react-router/blob/master/docs/API.md" target="_blank" rel="external">官方文档</a>，查看说明</p>
<h2 id="redux-和-react-redux"><a href="#redux-和-react-redux" class="headerlink" title="redux 和 react-redux"></a>redux 和 react-redux</h2><p>redux是JavaScript状态容器,用于管理应用的状态（个人理解实际就是应用的数据和引起数据变更的操作，在react应用开发里，就是指定渲染react组件需要的数据和各种回调函数）</p>
<p>redux基础概念</p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a><a href="http://cn.redux.js.org/docs/api/index.html" target="_blank" rel="external">API</a></h3><ul>
<li>createStore</li>
<li>Store</li>
<li>combineReducers</li>
<li>applyMiddleware</li>
<li>bindActionCreators</li>
<li>compose</li>
</ul>
<h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p>前端各种组件在特定的state下渲染会有所不同，一个展示组件就是通过state的变化来渲染界面的。<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">state = &#123;</div><div class="line"><span class="symbol">    todoReducer:</span> &#123;</div><div class="line"><span class="symbol">        todos:</span> [</div><div class="line">            &#123;<span class="string">text:</span><span class="string">'还书'</span>,<span class="string">completed:</span> <span class="literal">false</span>&#125;,</div><div class="line">            &#123;<span class="string">text:</span><span class="string">'买菜'</span>,<span class="string">completed:</span> <span class="literal">true</span>&#125;</div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="store"><a href="#store" class="headerlink" title="store"></a>store</h3><p>Store就是用来维持应用所有的state树的一个对象。应用的所有state以单一的对象存在一个单一的store中.可以理解为应用的数据库,存放渲染应用需要的所有数据。通过dispatch一个action来修改store中的state</p>
<p>Store对象的方法</p>
<ul>
<li>getState() 返回应用当前的 state 树。</li>
<li>dispatch(action) 分发 action。这是触发 state 变化的惟一途径</li>
<li>subscribe(listener) 添加一个变化监听器。每当 dispatch action 的时候就会执行，state 树中的一部分可能已经变化。你可以在回调函数里调用 getState() 来拿到当前 state。</li>
<li>replaceReducer(nextReducer) 替换 store 当前用来计算 state 的 reducer。</li>
</ul>
<h3 id="action"><a href="#action" class="headerlink" title="action"></a>action</h3><p>实际就是一个对像，必须包含一个<code>type</code>字段,<code>type</code>字段相当于定义了action的名字。通常长下面这个样子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ADD_TODO = <span class="string">"ADD_TODO"</span></div><div class="line">&#123;</div><div class="line">    <span class="attr">type</span>: ADD_TODO</div><div class="line">    text: <span class="string">''</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通常我们通过一个函数来封装action<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">todo</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">type</span>: ADD_TODO,</div><div class="line">        <span class="attr">text</span>: todo</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="reducers"><a href="#reducers" class="headerlink" title="reducers"></a>reducers</h3><p>实际就是回调函数的处理逻辑,响应的是<code>action</code>定义的操作，当<code>action</code>被调用的时候，触发指定的reducers函数，函数接受旧的state和action作为参数,返回一个新的state,新的state引起页面组件发生变化，从而使页面展示的信息发生变化</p>
<p>需要特别理解的是，reducers函数必须返回一个新的state对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">todoReducer</span>(<span class="params">state,action</span>)</span>&#123;</div><div class="line">        <span class="keyword">switch</span>(action.type)&#123;</div><div class="line">            <span class="keyword">case</span> ADD_TODO:</div><div class="line">                <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;,state,&#123;<span class="attr">text</span>:action.text,<span class="attr">completed</span>:<span class="literal">false</span>&#125;); <span class="comment">//合并新的</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">return</span> state;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dispatch"><a href="#dispatch" class="headerlink" title="dispatch"></a>dispatch</h3><p>有了<code>action</code>和<code>reducers</code>定义，那怎么把它们联系起来呢，这时候就要用到<code>dispatch</code>了。通常就是下面这个样子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dispatch(&#123;</div><div class="line">    <span class="attr">type</span>: ADD_TODO,</div><div class="line">    <span class="attr">text</span>: <span class="string">'喝水'</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p><code>dispatch</code> 的参数必须是一个<code>action</code> 对象（稍后会在react-thunk中再提到这个），调用<code>dispatch</code>后,指定的<code>reducers</code>将接收到这个调用，然后处理调用，返回新的状态。我们执行上面的<code>dispatch</code>后,state会变成下面这个样子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">state = &#123;</div><div class="line">    <span class="attr">todoReducer</span>: &#123;</div><div class="line">        <span class="attr">todos</span>: [</div><div class="line">            &#123;<span class="attr">text</span>:<span class="string">'还书'</span>,<span class="attr">completed</span>: <span class="literal">false</span>&#125;,</div><div class="line">            &#123;<span class="attr">text</span>:<span class="string">'买菜'</span>,<span class="attr">completed</span>: <span class="literal">true</span>&#125;,</div><div class="line">            &#123;<span class="attr">text</span>:<span class="string">'喝水'</span>,<span class="attr">completed</span>: <span class="literal">false</span>&#125; <span class="comment">//这一行是新添加的</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="整体过一遍"><a href="#整体过一遍" class="headerlink" title="整体过一遍"></a>整体过一遍</h3><ul>
<li>定义好<code>action</code>和<code>reducers</code></li>
<li>通过将reducers传递给｀createStore（）｀来创建一个<code>store</code>对象</li>
<li>在应用中通过<code>dispatch</code>方法触发<code>action</code>,改变<code>state</code></li>
</ul>
<h3 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h3><p>通过提供容器组件把sotre和dispatch绑定到真正展示用的组件中去</p>
<p>API</p>
<ul>
<li><code>&lt;Provider</code></li>
<li><code>connect()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></div><div class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> &#123;Provider&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> todoReducer <span class="keyword">from</span> <span class="string">'./reducers/todoReducer'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> store = createStore(todoReducer)</div><div class="line">ReactDOM.render((</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">App</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></div><div class="line">), <span class="built_in">document</span>.getElementById(<span class="string">'react-content'</span>));</div></pre></td></tr></table></figure>
<p>上面的代码中，我们通过传入｀todoReducer｀给<code>redux库</code>的<code>createStore</code>API函数，创建了<code>App</code>组件的唯一｀store｀对象。<br>然后再通过｀react-redux｀的<code>Provider</code>组件使得<code>Provider</code>之下的组件都能通过 <code>connect()</code> 方法获得 Redux store。</p>
<p>在App组件中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Reactfrom <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">'../pub/Header'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">          <span class="tag">&lt;<span class="name">Header</span>/&gt;</span></div><div class="line">          &#123;this.props.children&#125;</div><div class="line">          <span class="tag">&lt;<span class="name">Footer</span>/&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为App组件包裹在Provider之下，所以App下的Header组件也能通过connect获取store对象<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;PropTypes&#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123;initMenu&#125; <span class="keyword">from</span> <span class="string">'../actions/Action'</span></div><div class="line"><span class="keyword">import</span> MainMenu <span class="keyword">from</span> <span class="string">'./MainMenu'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  componentDidMount() &#123;</div><div class="line">    <span class="keyword">let</span> &#123;dispatch&#125; = <span class="keyword">this</span>.props.store</div><div class="line">    dispatch(addTodo())</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">header</span> <span class="attr">id</span>=<span class="string">"header"</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">store</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;<span class="attr">store</span>: store&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(Header)</div></pre></td></tr></table></figure></p>
<h2 id="react-thunk"><a href="#react-thunk" class="headerlink" title="react-thunk"></a>react-thunk</h2><p>上面谈<code>dispatch</code>的时候，我们说到，｀dispatch｀必须接受一个｀action｀对象作为参数，像如下这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">todo</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">type</span>: ADD_TODO,</div><div class="line">        <span class="attr">text</span>: todo</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>react-thunk是redux中间件，让<code>dispatch</code>能使用除了<code>action</code>以外的其它内容作为参数.比如下面的例子，我们定义一个fetchTodo函数，从某个远程接口获取一条todo数据，然后把这条数据通过dispatch添加到新的todo列表中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">todo</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">type</span>: ADD_TODO,</div><div class="line">        <span class="attr">text</span>: todo</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchTodo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</div><div class="line">        $.get(<span class="string">"http://api.com/gettodo"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">todo</span>)</span>&#123;</div><div class="line">            dispatch(addTodo(todo));</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/react/" rel="tag"># react</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/05/20/nodejs_stack/" rel="next" title="Node开发技术栈">
                <i class="fa fa-chevron-left"></i> Node开发技术栈
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/13/在多机部署时Yii的assetManager资源发布目录不一致问题/" rel="prev" title="在多机部署时 Yii 的 assetManager 资源发布目录不一致问题">
                在多机部署时 Yii 的 assetManager 资源发布目录不一致问题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="sandy1890" />
          <p class="site-author-name" itemprop="name">sandy1890</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#react"><span class="nav-number">2.</span> <span class="nav-text">react</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#react-router"><span class="nav-number">3.</span> <span class="nav-text">react-router</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#redux-和-react-redux"><span class="nav-number">4.</span> <span class="nav-text">redux 和 react-redux</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#API"><span class="nav-number">4.1.</span> <span class="nav-text">API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#state"><span class="nav-number">4.2.</span> <span class="nav-text">state</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#store"><span class="nav-number">4.3.</span> <span class="nav-text">store</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#action"><span class="nav-number">4.4.</span> <span class="nav-text">action</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reducers"><span class="nav-number">4.5.</span> <span class="nav-text">reducers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dispatch"><span class="nav-number">4.6.</span> <span class="nav-text">dispatch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#整体过一遍"><span class="nav-number">4.7.</span> <span class="nav-text">整体过一遍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#react-redux"><span class="nav-number">4.8.</span> <span class="nav-text">react-redux</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#react-thunk"><span class="nav-number">5.</span> <span class="nav-text">react-thunk</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sandy1890</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
